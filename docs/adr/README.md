# Architecture Decision Records

This directory contains Architecture Decision Records (ADRs) for the DECIDER project itself.

## What Are ADRs?

ADRs document significant architectural decisions along with their context, alternatives considered, and consequences. In DECIDER, ADRs include machine-readable metadata that enables tooling and AI agent integration.

## ADR Format

Each ADR is a Markdown file with YAML frontmatter:

```yaml
---
adr_id: ADR-NNNN
title: "Decision Title"
status: proposed | adopted | rejected | deprecated | superseded
date: YYYY-MM-DD
scope:
  paths:
    - "affected/path/**"
tags:
  - relevant-tag
constraints:
  - "Rule that MUST be followed"
invariants:
  - "Property that must always hold"
supersedes: []
superseded_by: []
related_adrs: []
---

# ADR-NNNN: Decision Title

## Context
<!-- Why is this decision needed? -->

## Decision
<!-- What did we decide and why? -->

## Alternatives Considered
<!-- What other options were evaluated? -->

## Consequences
<!-- What are the positive and negative impacts? -->
```

## Rationale Pattern

**All ADRs MUST use explicit rationale documentation.** This is enforced by `decider check adr --strict`.

### For Adopted Options

```markdown
### [Option Name]: Adopted

**Adopted because:**
- Concrete reason tied to decision drivers
- Technical, operational, or strategic justification

**Adopted despite:**
- Known downside consciously accepted
- Trade-off compared to alternatives
```

### For Rejected Alternatives

```markdown
### [Option Name]: Rejected

**Rejected because:**
- Concrete reason for rejection
- How it failed to meet decision drivers

**Rejected despite:**
- Legitimate strength of this option
- Benefit that made it attractive
```

### Why This Matters

- Forces explicit trade-off documentation
- Prevents hindsight bias
- Enables AI agents to understand decision context
- Makes code review of ADRs more objective

See [ADR-0005](0005-mandatory-rationale-pattern-for-adrs.md) for the full rationale behind this requirement.

## Key Concepts

### Status Lifecycle

| Status | Meaning |
|--------|---------|
| `proposed` | Under discussion, not yet decided |
| `adopted` | Approved and in effect |
| `rejected` | Considered and explicitly rejected |
| `deprecated` | Was adopted, now discouraged |
| `superseded` | Replaced by another ADR |

### Scope Paths

Glob patterns that define which code paths an ADR applies to:

```yaml
scope:
  paths:
    - "cmd/**"           # CLI entry points
    - "internal/adr/**"  # ADR parsing code
    - "**/*.proto"       # All protobuf files
```

### Constraints vs Invariants

- **Constraints**: Prescriptive rules (what to DO)
- **Invariants**: Properties that must hold (what must BE TRUE)

## Current ADRs

| ADR | Title | Status |
|-----|-------|--------|
| [ADR-0001](0001-adopt-go-for-decider-cli.md) | Adopt Go for DECIDER CLI | adopted |
| [ADR-0002](0002-adr-format-markdown-yaml-frontmatter.md) | ADR Format: Markdown with YAML Frontmatter | adopted |
| [ADR-0003](0003-repository-layout-and-index-format.md) | Repository Layout and Index Format | adopted |
| [ADR-0004](0004-release-process-goreleaser-github-actions.md) | Release Process: GoReleaser + GitHub Actions | adopted |
| [ADR-0005](0005-mandatory-rationale-pattern-for-adrs.md) | Mandatory Rationale Pattern for ADR Decisions | adopted |

## Working with ADRs

### Create a New ADR

```bash
decider new "Your Decision Title" --tags tag1,tag2 --paths "affected/**"
```

### List All ADRs

```bash
decider list
decider list --status adopted
decider list --tag foundation
```

### Validate ADRs

```bash
# Validate with warnings for missing rationale pattern
decider check adr

# Strict mode: fail on missing rationale pattern
decider check adr --strict
```

### Update the Index

```bash
decider index
```

### Check Which ADRs Apply to Changes

```bash
decider check diff --base main
decider explain --base main
```

## Index File

The `index.yaml` file is auto-generated by `decider index`. It provides quick access to ADR metadata:

```yaml
# AUTO-GENERATED by decider index - DO NOT EDIT
generated_at: "2026-01-16T10:00:00Z"
adr_count: 4
adrs:
  - adr_id: ADR-0001
    title: "Adopt Go for DECIDER CLI"
    status: adopted
    date: "2026-01-16"
    tags: [toolchain, language, foundation]
    scope_paths: ["cmd/**", "internal/**"]
    file: "0001-adopt-go-for-decider-cli.md"
```

**Never edit index.yaml manually.** Always use `decider index` to regenerate it.

## Template

The `templates/adr.md` file contains the template used by `decider new`. You can customize it for your project's needs.

## Further Reading

- [Writing Effective ADRs](../guides/writing-adrs.md)
- [SPEC.md](../../SPEC.md) - Complete ADR format specification
- [Michael Nygard's original ADR proposal](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions)
